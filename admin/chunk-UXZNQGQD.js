import{a as Ge}from"./chunk-Q5JEPQGK.js";import"./chunk-3YJIL2AV.js";import{a as W}from"./chunk-KXEIVXFQ.js";import{a as B,b as Ue}from"./chunk-HFRCUUGC.js";import{a as we}from"./chunk-TXZRVSHE.js";import{a as D}from"./chunk-BLDLELXJ.js";import{a as A}from"./chunk-DMJCAZU4.js";import"./chunk-E2VHAIMQ.js";import{e as k,f as me,g as Re,h as ke}from"./chunk-2S7Z6R6C.js";import{a as ye,c as $,d as ee,e as ie,f as te,g as ne,h as oe,k as re,l as ae,m as ce,p as le}from"./chunk-ATJWKJSD.js";import{B as Oe,a as de,b as ue,c as Ae,l as De,n as We,o as Be,p as pe,x as ze}from"./chunk-OXEFS4WE.js";import{$b as R,Aa as g,Ba as z,Ca as O,Db as H,Eb as Q,H as f,Ha as y,J as u,Ja as _,K as p,Ka as Ee,La as S,R as E,Rb as Ve,Tb as Ne,Ua as U,Ub as X,Xa as V,Ya as r,Z as j,Za as h,Zb as Y,_a as T,aa as a,bb as v,bc as se,ca as Pe,cb as C,cc as ge,db as b,eb as Te,gb as N,hb as w,ib as Le,ja as L,kb as J,lb as K,mb as Z,na as q,ra as x,sa as M,ta as I,va as F,wa as P,xa as d,ya as i,z as _e,za as o}from"./chunk-5G623SOG.js";import{a as Ie,b as Fe,d as Se}from"./chunk-KAT7YFEL.js";var xe=Se(ye());var fe=class{ordenCriterio;ordenTipo;parametro;valor;idpTipo;idpRecurso;pagina;registros;constructor(n,e,t,l,m,s,He,Qe){this.ordenCriterio=n,this.ordenTipo=e,this.parametro=t,this.valor=l,this.idpTipo=m,this.idpRecurso=s,this.pagina=He,this.registros=Qe}};var je=()=>["/configuraciones/editar"],qe=()=>["/dashboard/inicio"],ei=c=>["/configuraciones/editar/",c];function ii(c,n){if(c&1&&(i(0,"option",23),r(1),o()),c&2){let e=n.$implicit;d("ngValue",e.idParametro),a(),T(" ",e.nombre," ")}}function ti(c,n){if(c&1&&(i(0,"option",23),r(1),o()),c&2){let e=n.$implicit;d("ngValue",e.idParametro),a(),T(" ",e.nombre," ")}}function ni(c,n){if(c&1&&(i(0,"td"),r(1),o()),c&2){let e=S().$implicit;a(),h(e.valor)}}function oi(c,n){if(c&1&&(i(0,"td"),g(1,"img",45),o()),c&2){let e=S().$implicit,t=S();a(),d("src",e.urlImagen?t.urlPathImage+"archivos/configuracion/"+e.urlImagen:"archivos/configuracion/imagen.png",j)}}function ri(c,n){if(c&1&&(i(0,"tr")(1,"td"),r(2),o(),i(3,"td"),r(4),o(),x(5,ni,2,1,"td")(6,oi,2,1,"td"),i(7,"td",41),r(8),o(),i(9,"td",41),r(10),o(),i(11,"td",42),r(12),J(13,"date"),o(),i(14,"td",43)(15,"a",44),g(16,"fa-icon",26),o()()()),c&2){let e=n.$implicit,t=S();a(2),h(e.idConfiguracion),a(2),h(e.nombre),a(),M(e.pRecurso.idParametro===571?5:6),a(3),h(e.pTipo.nombre),a(2),h(e.pRecurso.nombre),a(2),T(" ",K(13,8,e.fecha,"dd/MM/yyyy")," "),a(3),d("routerLink",Le(11,ei,e.idConfiguracion)),a(),d("icon",t.faPencil)}}function ai(c,n){c&1&&(i(0,"tr")(1,"td",46)(2,"p",41),r(3,"No hay configuraciones existentes."),o()()())}function ci(c,n){if(c&1){let e=y();i(0,"div",47)(1,"h3",48),r(2," Administrador de archivos "),o(),i(3,"button",49),_("click",function(){let l=u(e).$implicit;return p(l.dismiss("Cross click"))}),o()(),i(4,"div",50),g(5,"file-manager"),o()}}var he=class c{urlPathImage=Y.URL_IMAGE;faTrash=Be;faPencil=Ae;faSearch=ze;faRefresh=De;faNewspaper=We;faArrowLeft=pe;configuracionFiltro=new fe("","","","",0,0,0,0);paginator=E(null);ptipos=E(null);precursos=E(null);configuraciones=E(null);modalServiceNotificacion;tipoFileManager="";ventanaFileManager;lconfiguraciones=!1;lptipos=!1;lprecursos=!1;closeResult;configuracionService=f(W);parametroService=f(A);loadingService=f(ge);modalService=f(B);ngbService=f(me);constructor(){localStorage.setItem("PALMER.admin.carpeta","gestor");let n=localStorage.getItem("PALMER.admin.filtroConfiguracion");n?this.configuracionFiltro=JSON.parse(n):this.filtroInicio(),this.parametroService.getParametros(new D("","","","",104,292,0,0)).pipe().subscribe(e=>{this.ptipos.set(e.content),this.lptipos=!0,this.actualizarCargador()}),this.parametroService.getParametros(new D("","","","",104,317,0,0)).pipe().subscribe(e=>{this.precursos.set(e.content),this.lprecursos=!0,this.actualizarCargador()}),this.getConfiguraciones(),this.iniciarConfiguracionModal()}iniciarConfiguracionModal(){this.modalServiceNotificacion=this.modalService.notificarEvento.subscribe(n=>{console.log("RETORNO"),n.origen=="filemanager"&&(n.retorno.imagen==!0,this.loadingService.hide(),this.ventanaFileManager.close()),window.scroll(0,0)})}eliminar(n){xe.default.fire({title:"Eliminar configuraci\xF3n!",text:`\xBFSeguro que desea eliminar la configuraci\xF3n "${n.nombre}"?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",reverseButtons:!0}).then(e=>{e.value&&this.configuracionService.eliminar(n.idConfiguracion).subscribe(()=>{xe.default.fire({title:"Configuraci\xF3n eliminada!",text:`La configuraci\xF3n "${n.nombre}" se elimin\xF3 con \xE9xito.`,icon:"success",confirmButtonText:"Aceptar"})})})}filtroInicio(){this.configuracionFiltro.ordenCriterio="idconfiguracion",this.configuracionFiltro.ordenTipo="asc",this.configuracionFiltro.parametro="nombre",this.configuracionFiltro.valor="",this.configuracionFiltro.idpTipo=0,this.configuracionFiltro.idpRecurso=0,this.configuracionFiltro.pagina=0,this.configuracionFiltro.registros=0}restablecer(){localStorage.removeItem("PALMER.admin.filtroConfiguracion"),this.filtroInicio(),this.getConfiguraciones()}actualizarPaginacion(){this.configuracionFiltro.pagina=1,this.getConfiguraciones()}cambiarPagina(n){this.configuracionFiltro.pagina=n,this.getConfiguraciones()}actualizar(){this.getConfiguraciones()}fileManager(n,e){console.log("iniciando filemanager"),this.tipoFileManager=e,this.ventanaFileManager=this.ngbService.open(n,{ariaLabelledBy:"modal-basic-title",windowClass:"ventanaFileManager"}),this.ventanaFileManager.result.then(t=>{console.log("entro"),this.closeResult=`Closed with: ${t}`},t=>{this.closeResult=`Dismissed ${this.getDismissReason(t)}`}),console.log("Finalizando filemanager")}getDismissReason(n){return n===k.ESC?"by pressing ESC":n===k.BACKDROP_CLICK?"by clicking on a backdrop":`with: ${n}`}getConfiguraciones(){this.loadingService.show(),localStorage.setItem("PALMER.admin.filtroConfiguracion",JSON.stringify(this.configuracionFiltro)),this.configuracionService.listar(this.configuracionFiltro).pipe().subscribe(n=>{this.paginator.set(n.paginator),this.configuraciones.set(n.content),this.lconfiguraciones=!0,this.actualizarCargador()})}actualizarCargador(){this.lptipos&&this.lconfiguraciones?this.loadingService.hide():this.loadingService.show()}static \u0275fac=function(e){return new(e||c)};static \u0275cmp=L({type:c,selectors:[["ng-component"]],features:[N([W,A,R])],decls:117,vars:25,consts:[["filtroForm","ngForm"],["content",""],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"page-title"],[1,"m-t-0","m-b-15"],[1,"d-flex","justify-content-start","gap-3","bg-light","border","p-3","my-2","sli"],[1,"form-group"],["id","name",1,"form-text"],["name","ordenCriterio",1,"form-select","custom-select","mr-sm-2",3,"ngModelChange","ngModel"],["value","idconfiguracion","selected",""],["value","nombre"],["value","valor"],["value","fecha"],[1,"form-group","m-r-5"],["name","ordenConfiguracion",1,"form-select","custom-select","mr-sm-2",3,"ngModelChange","ngModel"],["selected","","value","asc"],["value","desc"],["name","configuracion",1,"form-select","custom-select","mr-sm-2",3,"ngModelChange","ngModel"],["type","text","name","valor","placeholder","",1,"form-control",3,"ngModelChange","ngModel"],["name","idPtipo",1,"form-select","custom-select","mr-sm-2",3,"ngModelChange","ngModel"],[3,"ngValue"],["name","idPrecurso",1,"form-select","custom-select","mr-sm-2",3,"ngModelChange","ngModel"],["type","button",1,"form-control","btn","btn-primary",3,"click"],[3,"icon"],["type","button",1,"form-control","btn","btn-secondary",3,"click"],[1,"d-flex","justify-content-start","gap-3"],["type","button",1,"btn","btn-primary",3,"routerLink"],["type","button",1,"btn","btn-primary",3,"click"],[1,"btn","btn-secondary",3,"routerLink"],[1,"table-responsive"],[1,"table","table-hover"],[1,"thead-light"],["scope","col",2,"width","50px"],[1,"ng2-smart-sort-link","sort"],["scope","col"],["scope","col",1,"text-center",2,"width","130px"],["scope","col",1,"text-center",2,"width","110px"],["scope","col",1,"text-right",2,"width","70px"],[1,"text-center"],[1,"text-right"],[1,"text-end"],["placement","left","ngbTooltip","Editar configuraci\xF3n",1,"px-1",3,"routerLink"],["width","180px","alt","",3,"src"],["colspan","7"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"]],template:function(e,t){if(e&1){let l=y();i(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"h4",6),r(5,"Configuraci\xF3n base"),o(),g(6,"hr",7),i(7,"form",null,0)(9,"div",8)(10,"div",9)(11,"small",10),r(12,"Ordenar por"),o(),i(13,"select",11),b("ngModelChange",function(s){return u(l),C(t.configuracionFiltro.ordenCriterio,s)||(t.configuracionFiltro.ordenCriterio=s),p(s)}),i(14,"option",12),r(15,"ID"),o(),i(16,"option",13),r(17,"Nombre"),o(),i(18,"option",14),r(19,"Valor"),o(),i(20,"option",15),r(21,"Fecha de registro"),o()()(),i(22,"div",16)(23,"small",10),r(24,"\xA0"),o(),i(25,"select",17),b("ngModelChange",function(s){return u(l),C(t.configuracionFiltro.ordenTipo,s)||(t.configuracionFiltro.ordenTipo=s),p(s)}),i(26,"option",18),r(27,"Asc"),o(),i(28,"option",19),r(29,"Desc"),o()()(),i(30,"div",9)(31,"small",10),r(32,"Buscar por"),o(),i(33,"select",20),b("ngModelChange",function(s){return u(l),C(t.configuracionFiltro.parametro,s)||(t.configuracionFiltro.parametro=s),p(s)}),i(34,"option",13),r(35,"Nombre"),o()()(),i(36,"div",16)(37,"small",10),r(38,"\xA0"),o(),i(39,"input",21),b("ngModelChange",function(s){return u(l),C(t.configuracionFiltro.valor,s)||(t.configuracionFiltro.valor=s),p(s)}),o()(),i(40,"div",16)(41,"small",10),r(42,"Tipo "),o(),i(43,"select",22),b("ngModelChange",function(s){return u(l),C(t.configuracionFiltro.idpTipo,s)||(t.configuracionFiltro.idpTipo=s),p(s)}),i(44,"option",23),r(45,"Todos"),o(),F(46,ii,2,2,"option",23,I),o()(),i(48,"div",16)(49,"small",10),r(50,"Tipo Recurso"),o(),i(51,"select",24),b("ngModelChange",function(s){return u(l),C(t.configuracionFiltro.idpRecurso,s)||(t.configuracionFiltro.idpRecurso=s),p(s)}),i(52,"option",23),r(53,"Todos"),o(),F(54,ti,2,2,"option",23,I),o()(),i(56,"div",9)(57,"small",10),r(58,"\xA0"),o(),i(59,"button",25),_("click",function(){return u(l),p(t.actualizar())}),g(60,"fa-icon",26),r(61," Buscar "),o()(),i(62,"div",9)(63,"small",10),r(64,"\xA0"),o(),i(65,"button",27),_("click",function(){return u(l),p(t.restablecer())}),g(66,"fa-icon",26),o()()()(),i(67,"div",28)(68,"button",29),g(69,"fa-icon",26),r(70," Nuevo "),o(),i(71,"button",30),_("click",function(){u(l);let s=U(116);return p(t.fileManager(s,"contenido"))}),g(72,"fa-icon",26),r(73," Gestor de archivos "),o(),i(74,"button",31),g(75,"fa-icon",26),r(76," Regresar "),o()(),i(77,"div",32)(78,"table",33)(79,"thead")(80,"tr",34)(81,"th",35)(82,"a",36),r(83,"ID"),o()(),i(84,"th",37)(85,"a",36),r(86,"Nombre"),o()(),i(87,"th",37)(88,"a",36),r(89,"Valor/Imagen"),o()(),i(90,"th",38)(91,"a",36),r(92,"Tipo"),o()(),i(93,"th",38)(94,"a",36),r(95,"Tipo recurso"),o()(),i(96,"th",39)(97,"a",36),r(98,"Fecha"),o()(),i(99,"th",40),g(100,"a",36),o()()(),i(101,"tbody"),F(102,ri,17,13,"tr",null,I,!1,ai,4,0,"tr"),o()()(),i(105,"div",28)(106,"button",29),g(107,"fa-icon",26),r(108," Nuevo "),o(),i(109,"button",30),_("click",function(){u(l);let s=U(116);return p(t.fileManager(s,"contenido"))}),g(110,"fa-icon",26),r(111," Gestor de archivos "),o(),i(112,"button",31),g(113,"fa-icon",26),r(114," Regresar "),o()()()()()(),q(115,ci,6,0,"ng-template",null,1,Z)}e&2&&(a(13),v("ngModel",t.configuracionFiltro.ordenCriterio),a(12),v("ngModel",t.configuracionFiltro.ordenTipo),a(8),v("ngModel",t.configuracionFiltro.parametro),a(6),v("ngModel",t.configuracionFiltro.valor),a(4),v("ngModel",t.configuracionFiltro.idpTipo),a(),d("ngValue",0),a(2),P(t.ptipos()),a(5),v("ngModel",t.configuracionFiltro.idpRecurso),a(),d("ngValue",0),a(2),P(t.precursos()),a(6),d("icon",t.faSearch),a(6),d("icon",t.faRefresh),a(2),d("routerLink",w(21,je)),a(),d("icon",t.faNewspaper),a(3),d("icon",t.faNewspaper),a(2),d("routerLink",w(22,qe)),a(),d("icon",t.faArrowLeft),a(27),P(t.configuraciones()),a(4),d("routerLink",w(23,je)),a(),d("icon",t.faNewspaper),a(3),d("icon",t.faNewspaper),a(2),d("routerLink",w(24,qe)),a(),d("icon",t.faArrowLeft))},dependencies:[X,le,oe,ae,ce,$,re,ee,ie,ne,te,Q,ke,Re,se,ue,de,Ge,H],encapsulation:2})};var be=Se(ye());var Me=Se(ye());var ve=class c{etiqueta;loading=!1;archivoSeleccionado;modalService=f(B);constructor(){}ngOnInit(){this.etiqueta="Seleccionar una imagen"}seleccionarArchivo(n){this.archivoSeleccionado=n.target.files[0],this.etiqueta=this.archivoSeleccionado?this.archivoSeleccionado.name:"Seleccionar una imagen"}subirArchivo(){if(!this.archivoSeleccionado){Me.default.fire({title:"Subir una imagen!",text:"Debe seleccionar un archivo de imagen",icon:"error",confirmButtonText:"Aceptar"});return}let n=15*1024*1024;if(this.archivoSeleccionado.size>n){Me.default.fire({title:"Archivo muy grande",text:"El peso del archivo es mayor a 15 MB",icon:"error",confirmButtonText:"Aceptar"}),this.archivoSeleccionado=null,this.etiqueta="Seleccionar un archivo";return}let e=new Ue;e.origen="subirArchivo",e.retorno=this.archivoSeleccionado,this.modalService.notificarEvento.emit(e),console.log("Archivo subido:",this.archivoSeleccionado)}static \u0275fac=function(e){return new(e||c)};static \u0275cmp=L({type:c,selectors:[["configuracion-upload"]],features:[N([R])],decls:13,vars:1,consts:[[1,"row"],[1,"col-12"],[1,"card"],[1,"input-group"],[1,"custom-file"],["type","file",1,"custom-file-input",3,"change"],[1,"custom-file-label"],[1,"input-group-append"],["type","button","id","inputGroupFileAddon04",1,"btn","btn-primary",3,"click"],[1,"text-muted"]],template:function(e,t){e&1&&(z(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"input",5),Ee("change",function(m){return t.seleccionarArchivo(m)}),O(),z(6,"label",6),r(7),O()(),z(8,"div",7)(9,"button",8),Ee("click",function(){return t.subirArchivo()}),r(10,"Adjuntar imagen"),O()()()(),z(11,"small",9),r(12,"Imagen en formato: JPG, resoluci\xF3n: 72 ppi, ancho: 1200 px y alto: 630 px."),O()()()),e&2&&(a(7),h(t.etiqueta))},styles:[".ventanaSubirDeclaracion .modal-dialog{max-width:50%;width:50%}"]})};var Ce=class{idConfiguracion;nombre;valor;descripcion;urlImagen;fecha;pTipo;pRecurso};var Ze=()=>({idParametro:0}),li=()=>["/configuraciones/lista"];function si(c,n){if(c&1&&(i(0,"option",16),r(1),o()),c&2){let e=n.$implicit;d("ngValue",e),a(),T(" ",e.nombre," ")}}function mi(c,n){if(c&1&&(i(0,"option",16),r(1),o()),c&2){let e=n.$implicit;d("ngValue",e),a(),T(" ",e.nombre," ")}}function di(c,n){if(c&1){let e=y();i(0,"div",14)(1,"div")(2,"a",29),_("click",function(){u(e);let l=S(2);return p(l.eliminarImagen(l.configuracion()))}),r(3,"Eliminar imagen "),o()()()}}function ui(c,n){if(c&1){let e=y();i(0,"div",23)(1,"div",14)(2,"label",12),r(3,"Imagen "),i(4,"small"),r(5),o()(),i(6,"div")(7,"input",24),b("ngModelChange",function(l){u(e);let m=S();return C(m.configuracion().urlImagen,l)||(m.configuracion().urlImagen=l),p(l)}),o(),i(8,"button",25),_("click",function(){u(e);let l=S(),m=U(58);return p(l.abrirModalSubirImg(m))}),r(9," Adjuntar "),o(),g(10,"br"),i(11,"small",26),r(12,"Imagen en formato: JPG, resoluci\xF3n: 72 ppi, ancho: 566 px y alto: 344 px."),o()(),x(13,di,4,0,"div",14),o()(),i(14,"div",23)(15,"div",14)(16,"label",12),r(17,"Visualizaci\xF3n de imagen"),o(),i(18,"div",27),g(19,"img",28),o()()()}if(c&2){let e=S();a(),V(e.validarError("urlImagen",1)),a(4),h(e.validarError("urlImagen",2)),a(2),v("ngModel",e.configuracion().urlImagen),a(6),M(e.configuracion().urlImagen&&e.configuracion().idConfiguracion>0?13:-1),a(6),d("src",e.imageSrc?e.imageSrc:e.urlImagen?e.urlImagen:e.urlPathImage+"/archivos/configuracion/imagen.png",j)}}function pi(c,n){if(c&1){let e=y();i(0,"div",10)(1,"div",11)(2,"label",12),r(3,"Valor * "),i(4,"small"),r(5),o()(),i(6,"textarea",30),b("ngModelChange",function(l){u(e);let m=S();return C(m.configuracion().valor,l)||(m.configuracion().valor=l),p(l)}),o()()()}if(c&2){let e=S();a(),V(e.validarError("valor",1)),a(4),h(e.validarError("valor",2)),a(),v("ngModel",e.configuracion().valor)}}function gi(c,n){if(c&1&&(i(0,"div",10)(1,"div",14)(2,"label",12),r(3,"Fecha registro"),o(),g(4,"input",31),J(5,"date"),o()()),c&2){let e=S();a(4),d("value",Te(K(5,2,e.configuracion().fecha,"dd/MM/yyyy")))}}function fi(c,n){if(c&1){let e=y();i(0,"div",32)(1,"h4",33),r(2,"Adjuntar imagen"),o(),i(3,"button",34),_("click",function(){let l=u(e).$implicit;return p(l.dismiss("Cross click"))}),i(4,"span",35),r(5,"\xD7"),o()()(),i(6,"div",36),g(7,"configuracion-upload"),o(),i(8,"div",37)(9,"button",38),_("click",function(){let l=u(e).$implicit;return p(l.dismiss("Cross click"))}),r(10," Cerrar "),o()()}}var G=class c{urlPathImage=Y.URL_IMAGE;faCheck=Oe;faArrowLeft=pe;configuracion=E(new Ce);ptipos=E(null);precursos=E(null);errores=E(null);titulo="Nueva configuraci\xF3n";urlImagen;imageSrc;lconfiguraciones=!1;lptipos=!1;lprecursos=!1;modalServiceNotificacion;ventanaSubirImagen;closeResult=E("");archivoSeleccionado;router=f(Ne);configuracionService=f(W);parametroService=f(A);ngbService=f(me);modalService=f(B);activatedRoute=f(Ve);loadingService=f(ge);ngZone=f(Pe);constructor(){}ngOnInit(){this.activatedRoute.paramMap.subscribe(n=>{let e=+n.get("id");localStorage.setItem("PALMER.admin.carpeta","gestor"),e?(this.configuracionService.obtenerPorId(e).subscribe(t=>{this.configuracion.set(t),this.urlImagen=this.urlPathImage+"/archivos/configuracion/"+(this.configuracion().urlImagen!=null?this.configuracion().urlImagen:"imagen.png")}),this.titulo="Edici\xF3n de configuraci\xF3n"):(this.urlImagen=this.urlPathImage+"/archivos/configuracion/imagen.png",this.configuracion().nombre="",this.configuracion().valor="",this.configuracion().descripcion="",this.configuracion().pTipo=new we,this.configuracion().pTipo.idParametro=0,this.configuracion().pRecurso=new we,this.configuracion().pRecurso.idParametro=0),this.lconfiguraciones=!0}),this.parametroService.getParametros(new D("","","","",104,292,0,0)).pipe(_e(n=>{})).subscribe(n=>{this.ptipos.set(n.content),this.lptipos=!0,this.actualizarCargador()}),this.parametroService.getParametros(new D("","","","",104,317,0,0)).pipe(_e(n=>{})).subscribe(n=>{this.precursos.set(n.content),this.lptipos=!0,this.actualizarCargador()}),this.iniciarSuscripcionModal()}iniciarSuscripcionModal(){this.modalServiceNotificacion=this.modalService.notificarEvento.subscribe(n=>{if(console.log("RETORNO"),this.loadingService.show(),this.archivoSeleccionado=n.retorno,n.origen==="subirArchivo"){let e=new FileReader;e.onload=t=>{this.ngZone.run(()=>{this.imageSrc=t.target.result,this.configuracion.set(Fe(Ie({},this.configuracion()),{urlImagen:this.archivoSeleccionado.name}))})},e.readAsDataURL(this.archivoSeleccionado),this.ventanaSubirImagen.close()}this.loadingService.hide()})}ngOnDestroy(){this.modalServiceNotificacion.unsubscribe()}guardar(){this.loadingService.show(),this.configuracion().idConfiguracion===void 0?this.configuracionService.guardar(this.configuracion()).subscribe(n=>{this.configuracion.set(n),this.archivoSeleccionado!=null&&this.configuracionService.configuracionUpload(this.archivoSeleccionado,this.configuracion().idConfiguracion).subscribe(e=>{console.log("configuracion: "+e),this.configuracion.set(e),this.urlImagen,this.urlPathImage+""+(e.urlImagen!=null?e.urlImagen:"imagen.png"),this.imageSrc,this.urlPathImage+""+(e.urlImagen!=null?e.urlImagen:"imagen.png"),this.loadingService.hide()}),this.router.navigate(["/configuraciones/lista"]),be.default.fire({title:"Nueva configuraci\xF3n",text:`La configuraci\xF3n "${n.nombre}" ha sido creada con \xE9xito`,icon:"success",confirmButtonText:"Aceptar"})},n=>{this.errores.set(n.error.errors),this.loadingService.hide()}):this.configuracionService.actualizar(this.configuracion()).subscribe(n=>{this.archivoSeleccionado!=null&&this.configuracionService.configuracionUpload(this.archivoSeleccionado,this.configuracion().idConfiguracion).subscribe(e=>{this.configuracion.set(e),this.urlImagen,this.urlPathImage+""+(e.urlImagen!=null?e.urlImagen:"imagen.png")+Math.random(),this.imageSrc,this.urlPathImage+""+(e.urlImagen!=null?e.urlImagen:"imagen.png"),this.loadingService.hide()}),this.router.navigate(["/configuraciones/lista"]),be.default.fire({title:"Configuraci\xF3n actualizada",text:`La configuraci\xF3n "${n.nombre}" ha sido actualizada con \xE9xito`,icon:"success",confirmButtonText:"Aceptar"})},n=>{this.errores.set(n.error.errors),this.loadingService.hide()})}abrirModalSubirImg(n){this.ventanaSubirImagen=this.ngbService.open(n,{ariaLabelledBy:"modal-basic-title",windowClass:"ventanaSubirImagen"}),this.ventanaSubirImagen.result.then(e=>{this.closeResult.set(`Closed with: ${e}`)},e=>{this.closeResult.set(`Dismissed ${this.getDismissReason(e)}`)})}getDismissReason(n){return n===k.ESC?"by pressing ESC":n===k.BACKDROP_CLICK?"by clicking on a backdrop":`with: ${n}`}compararParametro(n,e){return n===void 0&&e===void 0?!0:n===null||e===null||n===void 0||e===void 0?!1:n.idParametro===e.idParametro}eliminarImagen(n){this.loadingService.show(),this.configuracionService.configuracionEliminarImagen(n.idConfiguracion).subscribe(e=>{this.configuracion.set(e),this.urlImagen="",this.imageSrc=this.urlPathImage+"/archivos/configuracion/imagen.png",be.default.fire({title:"Configuraci\xF3n",text:`La iamgen de la configuraci\xF3n "${e.nombre}" ha sido eliminado con \xE9xito`,icon:"success",confirmButtonText:"Aceptar"}),this.loadingService.hide()})}actualizarCargador(){this.lptipos&&this.lconfiguraciones?this.loadingService.hide():this.loadingService.show()}validarError(n,e){let t="",l=this.errores();return l&&l.forEach(m=>{m.campo===n&&(t=e===1?"errors":`(${m.valor})`)}),t}static \u0275fac=function(e){return new(e||c)};static \u0275cmp=L({type:c,selectors:[["app-configuracionEditar"]],features:[N([A,W,R])],decls:59,vars:27,consts:[["configuracionForm","ngForm"],["modalSubirImagen",""],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"m-t-0","m-b-15"],[1,"m-t-0"],[1,"row","p-t-5"],[1,"col-md-6","mb-3"],[1,"form-group","has-danger"],[1,"control-label"],["type","text","name","nombre","placeholder","",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-group"],["name","ptipo","id","ptipo","tabindex","1",1,"form-select","custom-select","mr-sm-2",3,"ngModelChange","ngModel","compareWith"],[3,"ngValue"],["name","precurso","id","precurso","tabindex","1",1,"form-select","custom-select","mr-sm-2",3,"ngModelChange","ngModel","compareWith"],["name","descripcion","id","descripcion","cols","2","rows","2",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-actions","py-3","d-flex","gap-3"],["type","submit","role","button",1,"btn","btn-primary",3,"click"],[3,"icon"],[1,"btn","btn-secondary",3,"routerLink"],[1,"col-md-3"],["type","text","name","urlImagen","readonly","",1,"form-control",2,"display","inline","max-width","75%","margin-right","5px",3,"ngModelChange","ngModel"],[1,"btn","btn-secondary",2,"display","inline","margin-right","5px",3,"click"],[1,"text-muted"],[1,"box-img"],[1,"col-md-5",3,"src"],["href","javascript:void(0);",1,"btn-eliminar",3,"click"],["name","valor","id","valor","cols","2","rows","2",1,"form-control",3,"ngModelChange","ngModel"],["type","text","name","fecha","disabled","",1,"form-control",3,"value"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-inverse",3,"click"]],template:function(e,t){if(e&1){let l=y();i(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"h4",6),r(5),o(),g(6,"hr",7),i(7,"form",8,0)(9,"div",9)(10,"div",10)(11,"div",11)(12,"label",12),r(13,"Nombre * "),i(14,"small"),r(15),o()(),i(16,"input",13),b("ngModelChange",function(s){return u(l),C(t.configuracion().nombre,s)||(t.configuracion().nombre=s),p(s)}),o()()(),i(17,"div",10)(18,"div",14)(19,"label",12),r(20,"Tipo "),i(21,"small"),r(22),o()(),i(23,"select",15),b("ngModelChange",function(s){return u(l),C(t.configuracion().pTipo,s)||(t.configuracion().pTipo=s),p(s)}),i(24,"option",16),r(25,"Seleccione"),o(),F(26,si,2,2,"option",16,I),o()()()(),i(28,"div",9)(29,"div",10)(30,"div",14)(31,"label",12),r(32,"Tipo Recurso "),i(33,"small"),r(34),o()(),i(35,"select",17),b("ngModelChange",function(s){return u(l),C(t.configuracion().pRecurso,s)||(t.configuracion().pRecurso=s),p(s)}),i(36,"option",16),r(37,"Seleccione"),o(),F(38,mi,2,2,"option",16,I),o()()(),x(40,ui,20,6),o(),i(41,"div",9),x(42,pi,7,4,"div",10),i(43,"div",10)(44,"div",11)(45,"label",12),r(46,"Descripci\xF3n"),o(),i(47,"textarea",18),b("ngModelChange",function(s){return u(l),C(t.configuracion().descripcion,s)||(t.configuracion().descripcion=s),p(s)}),o()()()(),i(48,"div",9),x(49,gi,6,5,"div",10),o(),i(50,"div",19)(51,"button",20),_("click",function(){return u(l),p(t.guardar())}),g(52,"fa-icon",21),r(53," Guardar "),o(),i(54,"a",22),g(55,"fa-icon",21),r(56," Regresar"),o()()()()()()(),q(57,fi,11,0,"ng-template",null,1,Z)}if(e&2){let l,m;a(5),h(t.titulo),a(6),V(t.validarError("nombre",1)),a(4),h(t.validarError("nombre",2)),a(),v("ngModel",t.configuracion().nombre),a(2),V(t.validarError("ptipo",1)),a(4),h(t.validarError("ptipo",2)),a(),v("ngModel",t.configuracion().pTipo),d("compareWith",t.compararParametro),a(),d("ngValue",w(24,Ze)),a(2),P(t.ptipos()),a(4),V(t.validarError("precurso",1)),a(4),h(t.validarError("precurso",2)),a(),v("ngModel",t.configuracion().pRecurso),d("compareWith",t.compararParametro),a(),d("ngValue",w(25,Ze)),a(2),P(t.precursos()),a(2),M(((l=t.configuracion().pRecurso)==null?null:l.idParametro)==570?40:-1),a(2),M(((m=t.configuracion().pRecurso)==null?null:m.idParametro)==571?42:-1),a(5),v("ngModel",t.configuracion().descripcion),a(2),M(t.configuracion().idConfiguracion>0?49:-1),a(3),d("icon",t.faCheck),a(2),d("routerLink",w(26,li)),a(),d("icon",t.faArrowLeft)}},dependencies:[ue,de,ve,se,X,Q,le,oe,ae,ce,$,re,ee,ie,ne,te,H],encapsulation:2})};var _t=[{path:"",children:[{path:"lista",component:he,data:{title:"Configuraci\xF3n base",urls:[{title:"Dashboard",url:"/dashboard/inicio"},{title:"Configuraci\xF3n base"}]}},{path:"editar",component:G,data:{title:"Nueva configuraci\xF3n",permiso:["web_configuracion_nuevo_editar"],urls:[{title:"Dashboard",url:"/dashboard/inicio"},{title:"Configuraci\xF3n base",url:"/configuraciones/lista"},{title:"Nueva configuraci\xF3n"}]}},{path:"editar/:id",component:G,data:{title:"Edici\xF3n de configuraci\xF3n",permiso:["web_configuracion_nuevo_editar"],urls:[{title:"Dashboard",url:"/dashboard/inicio"},{title:"Configuraci\xF3n base",url:"/configuraciones/lista"},{title:"Edici\xF3n de configuraci\xF3n"}]}}]}];export{_t as default};
